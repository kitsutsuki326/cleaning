<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>掃除スケジュール管理</title>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body>
    <div id="root"></div>
    
    <script type="text/babel">
        const { useState, useEffect } = React;
        
        // Lucide icons as inline SVG components
        const Home = ({ size = 24, className = "" }) => (
            <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
                <path d="m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path>
                <polyline points="9 22 9 12 15 12 15 22"></polyline>
            </svg>
        );
        
        const Droplets = ({ size = 24, className = "" }) => (
            <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
                <path d="M7 16.3c2.2 0 4-1.83 4-4.05 0-1.16-.57-2.26-1.71-3.19S7.29 6.75 7 5.3c-.29 1.45-1.14 2.84-2.29 3.76S3 11.1 3 12.25c0 2.22 1.8 4.05 4 4.05z"></path>
                <path d="M12.56 6.6A10.97 10.97 0 0 0 14 3.02c.5 2.5 2 4.9 4 6.5s3 3.5 3 5.5a6.98 6.98 0 0 1-11.91 4.97"></path>
            </svg>
        );
        
        const Bath = ({ size = 24, className = "" }) => (
            <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
                <path d="M9 6 6.5 3.5a1.5 1.5 0 0 0-1-.5C4.683 3 4 3.683 4 4.5V17a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-5"></path>
                <line x1="10" x2="8" y1="5" y2="7"></line>
                <line x1="2" x2="22" y1="12" y2="12"></line>
                <line x1="7" x2="7" y1="19" y2="21"></line>
                <line x1="17" x2="17" y1="19" y2="21"></line>
            </svg>
        );
        
        const Bed = ({ size = 24, className = "" }) => (
            <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
                <path d="M2 4v16"></path>
                <path d="M2 8h18a2 2 0 0 1 2 2v10"></path>
                <path d="M2 17h20"></path>
                <path d="M6 8v9"></path>
            </svg>
        );
        
        const Utensils = ({ size = 24, className = "" }) => (
            <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
                <path d="M3 2v7c0 1.1.9 2 2 2h4a2 2 0 0 0 2-2V2"></path>
                <path d="M7 2v20"></path>
                <path d="M21 15V2v0a5 5 0 0 0-5 5v6c0 1.1.9 2 2 2h3Zm0 0v7"></path>
            </svg>
        );
        
        const Coffee = ({ size = 24, className = "" }) => (
            <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
                <path d="M17 8h1a4 4 0 1 1 0 8h-1"></path>
                <path d="M3 8h14v9a4 4 0 0 1-4 4H7a4 4 0 0 1-4-4Z"></path>
                <line x1="6" x2="6" y1="2" y2="4"></line>
                <line x1="10" x2="10" y1="2" y2="4"></line>
                <line x1="14" x2="14" y1="2" y2="4"></line>
            </svg>
        );
        
        const Plus = ({ size = 24, className = "" }) => (
            <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
                <line x1="12" x2="12" y1="5" y2="19"></line>
                <line x1="5" x2="19" y1="12" y2="12"></line>
            </svg>
        );
        
        const Trash2 = ({ size = 24, className = "" }) => (
            <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
                <polyline points="3 6 5 6 21 6"></polyline>
                <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path>
                <line x1="10" x2="10" y1="11" y2="17"></line>
                <line x1="14" x2="14" y1="11" y2="17"></line>
            </svg>
        );
        
        const Check = ({ size = 24, className = "" }) => (
            <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
                <polyline points="20 6 9 17 4 12"></polyline>
            </svg>
        );
        
        const AlertCircle = ({ size = 24, className = "" }) => (
            <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
                <circle cx="12" cy="12" r="10"></circle>
                <line x1="12" x2="12" y1="8" y2="12"></line>
                <line x1="12" x2="12.01" y1="16" y2="16"></line>
            </svg>
        );

        function CleaningScheduleApp() {
          const [rooms, setRooms] = useState([]);
          const [showAddRoom, setShowAddRoom] = useState(false);
          const [newRoom, setNewRoom] = useState({
            name: '',
            frequency: 7,
            icon: 'home'
          });

          const iconOptions = [
            { value: 'home', label: 'リビング', Icon: Home },
            { value: 'droplets', label: 'バスルーム', Icon: Droplets },
            { value: 'bath', label: 'トイレ', Icon: Bath },
            { value: 'bed', label: '寝室', Icon: Bed },
            { value: 'utensils', label: 'キッチン', Icon: Utensils },
            { value: 'coffee', label: 'ダイニング', Icon: Coffee },
          ];

          useEffect(() => {
            try {
              const saved = localStorage.getItem('cleaning-rooms');
              if (saved) {
                setRooms(JSON.parse(saved));
              }
            } catch (error) {
              console.log('No existing rooms found');
            }
          }, []);

          useEffect(() => {
            if (rooms.length >= 0) {
              try {
                localStorage.setItem('cleaning-rooms', JSON.stringify(rooms));
              } catch (error) {
                console.error('Failed to save rooms:', error);
              }
            }
          }, [rooms]);

          const addRoom = () => {
            if (newRoom.name.trim()) {
              setRooms([...rooms, {
                id: Date.now(),
                name: newRoom.name,
                frequency: newRoom.frequency,
                icon: newRoom.icon,
                lastCleaned: null,
                history: []
              }]);
              setNewRoom({ name: '', frequency: 7, icon: 'home' });
              setShowAddRoom(false);
            }
          };

          const markAsCleaned = (id) => {
            const now = new Date().toISOString();
            setRooms(rooms.map(room =>
              room.id === id
                ? {
                    ...room,
                    lastCleaned: now,
                    history: [...(room.history || []), now].slice(-10)
                  }
                : room
            ));
          };

          const deleteRoom = (id) => {
            setRooms(rooms.filter(room => room.id !== id));
          };

          const getDaysSinceLastCleaned = (lastCleaned) => {
            if (!lastCleaned) return null;
            const now = new Date();
            const last = new Date(lastCleaned);
            return Math.floor((now - last) / (1000 * 60 * 60 * 24));
          };

          const getUrgencyLevel = (room) => {
            const daysSince = getDaysSinceLastCleaned(room.lastCleaned);
            if (daysSince === null) return 'never';
            
            const ratio = daysSince / room.frequency;
            if (ratio >= 1.5) return 'overdue';
            if (ratio >= 1) return 'urgent';
            if (ratio >= 0.7) return 'soon';
            return 'clean';
          };

          const getUrgencyColor = (level) => {
            switch (level) {
              case 'never': return 'bg-gray-100 border-gray-300 text-gray-600';
              case 'overdue': return 'bg-red-50 border-red-400 text-red-800 shadow-lg shadow-red-100';
              case 'urgent': return 'bg-orange-50 border-orange-400 text-orange-800 shadow-md shadow-orange-100';
              case 'soon': return 'bg-yellow-50 border-yellow-400 text-yellow-800';
              case 'clean': return 'bg-green-50 border-green-400 text-green-800';
              default: return 'bg-gray-100 border-gray-300';
            }
          };

          const getUrgencyMessage = (room) => {
            const level = getUrgencyLevel(room);
            const daysSince = getDaysSinceLastCleaned(room.lastCleaned);
            
            if (level === 'never') return '未掃除';
            if (level === 'overdue') return `${daysSince}日経過 - 至急！`;
            if (level === 'urgent') return `${daysSince}日経過 - 掃除が必要`;
            if (level === 'soon') return `${daysSince}日経過 - そろそろ`;
            return `${daysSince}日経過 - まだ綺麗`;
          };

          const getIconComponent = (iconValue) => {
            const option = iconOptions.find(opt => opt.value === iconValue);
            return option ? option.Icon : Home;
          };

          const sortedRooms = [...rooms].sort((a, b) => {
            const urgencyOrder = { overdue: 0, urgent: 1, never: 2, soon: 3, clean: 4 };
            return urgencyOrder[getUrgencyLevel(a)] - urgencyOrder[getUrgencyLevel(b)];
          });

          const stats = {
            total: rooms.length,
            overdue: rooms.filter(r => getUrgencyLevel(r) === 'overdue').length,
            urgent: rooms.filter(r => getUrgencyLevel(r) === 'urgent').length,
            clean: rooms.filter(r => getUrgencyLevel(r) === 'clean').length,
          };

          return (
            <div className="min-h-screen bg-gradient-to-br from-blue-50 via-indigo-50 to-purple-50 p-4 sm:p-8">
              <div className="max-w-4xl mx-auto">
                <div className="bg-white rounded-2xl shadow-xl overflow-hidden mb-6">
                  <div className="bg-gradient-to-r from-blue-600 to-indigo-700 p-6 sm:p-8">
                    <h1 className="text-3xl sm:text-4xl font-bold text-white mb-2 flex items-center gap-3">
                      <Home size={36} />
                      掃除スケジュール管理
                    </h1>
                    <p className="text-blue-100">
                      部屋ごとの掃除状況を一目で確認
                    </p>
                  </div>

                  <div className="grid grid-cols-2 sm:grid-cols-4 gap-4 p-6 bg-gray-50">
                    <div className="text-center">
                      <div className="text-2xl font-bold text-gray-800">{stats.total}</div>
                      <div className="text-xs text-gray-600">登録部屋数</div>
                    </div>
                    <div className="text-center">
                      <div className="text-2xl font-bold text-red-600">{stats.overdue}</div>
                      <div className="text-xs text-gray-600">至急</div>
                    </div>
                    <div className="text-center">
                      <div className="text-2xl font-bold text-orange-600">{stats.urgent}</div>
                      <div className="text-xs text-gray-600">要掃除</div>
                    </div>
                    <div className="text-center">
                      <div className="text-2xl font-bold text-green-600">{stats.clean}</div>
                      <div className="text-xs text-gray-600">綺麗</div>
                    </div>
                  </div>
                </div>

                {!showAddRoom && (
                  <button
                    onClick={() => setShowAddRoom(true)}
                    className="w-full mb-6 bg-white hover:bg-blue-50 border-2 border-dashed border-blue-300 rounded-xl p-4 text-blue-600 font-medium transition-colors flex items-center justify-center gap-2"
                  >
                    <Plus size={20} />
                    新しい部屋を追加
                  </button>
                )}

                {showAddRoom && (
                  <div className="bg-white rounded-xl shadow-lg p-6 mb-6 border-2 border-blue-300">
                    <h3 className="font-bold text-lg mb-4 text-gray-800">新しい部屋を追加</h3>
                    <div className="space-y-4">
                      <div>
                        <label className="block text-sm font-medium text-gray-700 mb-2">
                          部屋名
                        </label>
                        <input
                          type="text"
                          value={newRoom.name}
                          onChange={(e) => setNewRoom({ ...newRoom, name: e.target.value })}
                          placeholder="例: リビング、キッチン"
                          className="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                        />
                      </div>
                      <div>
                        <label className="block text-sm font-medium text-gray-700 mb-2">
                          掃除頻度（日数）
                        </label>
                        <input
                          type="number"
                          value={newRoom.frequency}
                          onChange={(e) => setNewRoom({ ...newRoom, frequency: parseInt(e.target.value) })}
                          min="1"
                          className="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                        />
                        <p className="text-xs text-gray-500 mt-1">
                          {newRoom.frequency}日ごとに掃除が必要
                        </p>
                      </div>
                      <div>
                        <label className="block text-sm font-medium text-gray-700 mb-2">
                          アイコン
                        </label>
                        <div className="grid grid-cols-3 sm:grid-cols-6 gap-2">
                          {iconOptions.map(({ value, label, Icon }) => (
                            <button
                              key={value}
                              onClick={() => setNewRoom({ ...newRoom, icon: value })}
                              className={`p-3 rounded-lg border-2 transition-all ${
                                newRoom.icon === value
                                  ? 'border-blue-500 bg-blue-50'
                                  : 'border-gray-200 hover:border-blue-300'
                              }`}
                            >
                              <Icon size={24} className="mx-auto" />
                              <div className="text-xs mt-1">{label}</div>
                            </button>
                          ))}
                        </div>
                      </div>
                      <div className="flex gap-2">
                        <button
                          onClick={addRoom}
                          className="flex-1 bg-blue-600 hover:bg-blue-700 text-white py-2 rounded-lg font-medium transition-colors"
                        >
                          追加
                        </button>
                        <button
                          onClick={() => setShowAddRoom(false)}
                          className="flex-1 bg-gray-200 hover:bg-gray-300 text-gray-700 py-2 rounded-lg font-medium transition-colors"
                        >
                          キャンセル
                        </button>
                      </div>
                    </div>
                  </div>
                )}

                <div className="space-y-4">
                  {sortedRooms.length === 0 ? (
                    <div className="bg-white rounded-xl p-12 text-center text-gray-400 shadow">
                      <Home size={48} className="mx-auto mb-4 opacity-50" />
                      <p className="text-lg">部屋を追加して掃除スケジュールを管理しましょう</p>
                    </div>
                  ) : (
                    sortedRooms.map(room => {
                      const IconComponent = getIconComponent(room.icon);
                      const urgencyLevel = getUrgencyLevel(room);
                      const urgencyColor = getUrgencyColor(urgencyLevel);
                      
                      return (
                        <div
                          key={room.id}
                          className={`rounded-xl p-6 border-2 transition-all ${urgencyColor}`}
                        >
                          <div className="flex items-start justify-between mb-4">
                            <div className="flex items-center gap-3">
                              <div className="bg-white p-3 rounded-lg shadow-sm">
                                <IconComponent size={28} />
                              </div>
                              <div>
                                <h3 className="font-bold text-xl">{room.name}</h3>
                                <p className="text-sm opacity-75">
                                  {room.frequency}日ごとに掃除
                                </p>
                              </div>
                            </div>
                            <button
                              onClick={() => deleteRoom(room.id)}
                              className="text-gray-400 hover:text-red-600 transition-colors"
                            >
                              <Trash2 size={20} />
                            </button>
                          </div>

                          <div className="flex items-center justify-between">
                            <div className="flex items-center gap-2">
                              {urgencyLevel === 'overdue' && <AlertCircle size={20} />}
                              <span className="font-semibold">
                                {getUrgencyMessage(room)}
                              </span>
                            </div>
                            <button
                              onClick={() => markAsCleaned(room.id)}
                              className="bg-white hover:bg-opacity-80 px-4 py-2 rounded-lg font-medium shadow-sm transition-all flex items-center gap-2"
                            >
                              <Check size={18} />
                              掃除完了
                            </button>
                          </div>

                          {room.lastCleaned && (
                            <div className="mt-3 pt-3 border-t border-current border-opacity-20">
                              <p className="text-sm opacity-75">
                                最終掃除: {new Date(room.lastCleaned).toLocaleDateString('ja-JP')}
                              </p>
                            </div>
                          )}
                        </div>
                      );
                    })
                  )}
                </div>
              </div>
            </div>
          );
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<CleaningScheduleApp />);
    </script>
</body>
</html>
